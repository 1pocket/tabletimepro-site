<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Subscription started</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"></head><body><main class="container"><h1>You're in!</h1><p>Thanks for subscribing to <strong>TableTime Pro</strong>. We'll email your access details shortly.</p><p><a href="/">Back to homepage</a></p></main></body></html>
<script>
(async () => {
  const params = new URLSearchParams(location.search);
  const sid = params.get('session_id');
  if (!sid) return;

  try {
    const res = await fetch('/.netlify/functions/provision-info?session_id=' + encodeURIComponent(sid));
    if (!res.ok) return;
    const info = await res.json();

    // Save for the apps
    localStorage.setItem('ttpro_tenant', info.tenant);
    localStorage.setItem('ttpro_key', info.key);

    // Update launch buttons if present
    const staffBtn = document.getElementById('launch-staff');   // add id to your button
    const venueBtn = document.getElementById('launch-venue');   // add id to your button
    if (staffBtn) staffBtn.href = 'https://staff.tabletimepro.com/?tenant=' + info.tenant;
    if (venueBtn) venueBtn.href = 'https://venue.tabletimepro.com/?tenant=' + info.tenant;
  } catch (e) {
    console.warn('provision-info failed', e);
  }
})();
</script>
